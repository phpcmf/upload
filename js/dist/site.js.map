{"version":3,"file":"site.js","mappings":"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","sources":["webpack://@cmf/upload/webpack/bootstrap","webpack://@cmf/upload/webpack/runtime/compat get default export","webpack://@cmf/upload/webpack/runtime/define property getters","webpack://@cmf/upload/webpack/runtime/hasOwnProperty shorthand","webpack://@cmf/upload/webpack/runtime/make namespace object","webpack://@cmf/upload/external root \"cmf.core.compat['common/extend']\"","webpack://@cmf/upload/external root \"cmf.core.compat['site/app']\"","webpack://@cmf/upload/external root \"cmf.core.compat['site/components/UserPage']\"","webpack://@cmf/upload/external root \"cmf.core.compat['common/components/LinkButton']\"","webpack://@cmf/upload/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@cmf/upload/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@cmf/upload/external root \"cmf.core.compat['common/Model']\"","webpack://@cmf/upload/external root \"cmf.core.compat['common/utils/mixin']\"","webpack://@cmf/upload/./src/common/models/File.js","webpack://@cmf/upload/./src/site/states/FileListState.js","webpack://@cmf/upload/external root \"cmf.core.compat['site/components/Post']\"","webpack://@cmf/upload/external root \"cmf.core.compat['common/components/TextEditor']\"","webpack://@cmf/upload/external root \"cmf.core.compat['common/Component']\"","webpack://@cmf/upload/external root \"cmf.core.compat['common/components/Button']\"","webpack://@cmf/upload/external root \"cmf.core.compat['common/components/LoadingIndicator']\"","webpack://@cmf/upload/external root \"cmf.core.compat['common/utils/classList']\"","webpack://@cmf/upload/external root \"cmf.core.compat['common/components/Tooltip']\"","webpack://@cmf/upload/./src/site/components/UploadButton.js","webpack://@cmf/upload/./src/site/components/DragAndDrop.js","webpack://@cmf/upload/./src/site/components/PasteClipboard.js","webpack://@cmf/upload/./src/site/handler/Uploader.js","webpack://@cmf/upload/external root \"cmf.core.compat['common/components/Modal']\"","webpack://@cmf/upload/external root \"cmf.core.compat['common/components/Alert']\"","webpack://@cmf/upload/external root \"cmf.core.compat['common/utils/extractText']\"","webpack://@cmf/upload/./src/common/mimeToIcon.js","webpack://@cmf/upload/./src/site/components/UserFileList.js","webpack://@cmf/upload/./src/site/components/FileManagerModal.js","webpack://@cmf/upload/./src/site/components/FileManagerButton.js","webpack://@cmf/upload/./src/site/components/UploadsUserPage.js","webpack://@cmf/upload/external root \"cmf.core.compat['common/models/User']\"","webpack://@cmf/upload/./src/site/components/index.js","webpack://@cmf/upload/./src/site/index.js","webpack://@cmf/upload/./src/site/addUploadButton.js","webpack://@cmf/upload/./src/site/downloadButtonInteraction.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = cmf.core.compat['common/extend'];","const __WEBPACK_NAMESPACE_OBJECT__ = cmf.core.compat['site/app'];","const __WEBPACK_NAMESPACE_OBJECT__ = cmf.core.compat['site/components/UserPage'];","const __WEBPACK_NAMESPACE_OBJECT__ = cmf.core.compat['common/components/LinkButton'];","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  setPrototypeOf(subClass, superClass);\n}","const __WEBPACK_NAMESPACE_OBJECT__ = cmf.core.compat['common/Model'];","const __WEBPACK_NAMESPACE_OBJECT__ = cmf.core.compat['common/utils/mixin'];","import Model from 'cmf/common/Model';\nimport mixin from 'cmf/common/utils/mixin';\n\nexport default class File extends mixin(Model, {\n  baseName: Model.attribute('baseName'),\n  path: Model.attribute('path'),\n  url: Model.attribute('url'),\n  type: Model.attribute('type'),\n  size: Model.attribute('size'),\n  humanSize: Model.attribute('humanSize'),\n  createdAt: Model.attribute('createdAt'),\n  uuid: Model.attribute('uuid'),\n  tag: Model.attribute('tag'),\n  hidden: Model.attribute('hidden'),\n  bbcode: Model.attribute('bbcode'),\n}) {\n  /**\n   * Use Cmf Uploads endpoint\n   */\n  apiEndpoint() {\n    return '/cmf/uploads' + (this.exists ? '/' + this.data.id : '');\n  }\n}\n","import app from 'cmf/site/app';\n\nexport default class FileListState {\n  constructor() {\n    this.user = null;\n\n    this.files = [];\n\n    this.moreResults = false;\n\n    this.loading = false;\n  }\n\n  /**\n   * Set user and load list\n   *\n   * @param user A user to populate the media manager\n   */\n  setUser(user) {\n    // Keep previous state\n    if (user === this.user) return;\n\n    // Set user\n    this.user = user;\n\n    // Reset file list\n    this.files = [];\n\n    // Load user files\n    this.loadResults();\n  }\n\n  /**\n   * Load more user files\n   *\n   * @param offset The index to start the page at.\n   */\n  loadResults(offset = 0) {\n    if (!this.user) return;\n\n    this.loading = true;\n\n    return app.store\n      .find('cmf/uploads', {\n        filter: {\n          user: this.user.id(),\n        },\n        page: {\n          offset,\n        },\n      })\n      .then(this.parseResults.bind(this));\n  }\n\n  /**\n   * Load the next page of discussion results.\n   */\n  loadMore() {\n    this.loading = true;\n\n    this.loadResults(this.files.length).then(this.parseResults.bind(this));\n  }\n\n  /**\n   * Parse results and append them to the file list.\n   */\n  parseResults(results) {\n    this.files.push(...results);\n\n    this.loading = false;\n    this.moreResults = !!results.payload.links && !!results.payload.links.next;\n\n    m.redraw();\n\n    return results;\n  }\n\n  /**\n   * Add files to the beginning of the list\n   */\n  addToList(files) {\n    if (Array.isArray(files)) {\n      this.files.unshift(...files);\n    } else {\n      this.files.unshift(files);\n    }\n  }\n\n  /**\n   * Are there any files in the list?\n   */\n  hasFiles() {\n    return this.files.length > 0;\n  }\n\n  /**\n   * Is the file list loading?\n   */\n  isLoading() {\n    return this.loading;\n  }\n\n  /**\n   * Does this user has more files?\n   */\n  hasMoreResults() {\n    return this.moreResults;\n  }\n\n  /**\n   * Does this user have any files?\n   */\n  empty() {\n    return !this.hasFiles() && !this.isLoading();\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = cmf.core.compat['site/components/Post'];","const __WEBPACK_NAMESPACE_OBJECT__ = cmf.core.compat['common/components/TextEditor'];","const __WEBPACK_NAMESPACE_OBJECT__ = cmf.core.compat['common/Component'];","const __WEBPACK_NAMESPACE_OBJECT__ = cmf.core.compat['common/components/Button'];","const __WEBPACK_NAMESPACE_OBJECT__ = cmf.core.compat['common/components/LoadingIndicator'];","const __WEBPACK_NAMESPACE_OBJECT__ = cmf.core.compat['common/utils/classList'];","const __WEBPACK_NAMESPACE_OBJECT__ = cmf.core.compat['common/components/Tooltip'];","import app from 'cmf/site/app';\nimport Component from 'cmf/common/Component';\nimport Button from 'cmf/common/components/Button';\nimport LoadingIndicator from 'cmf/common/components/LoadingIndicator';\nimport classList from 'cmf/common/utils/classList';\nimport Tooltip from 'cmf/common/components/Tooltip';\n\nexport default class UploadButton extends Component {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    this.attrs.uploader.on('uploaded', () => {\n      // 重置新上传的按钮\n      this.$('form')[0].reset();\n\n      // 重新绘制以反映 DOM 中的 uploader.loading\n      m.redraw();\n    });\n\n    this.isMediaUploadButton = vnode.attrs.isMediaUploadButton || false;\n  }\n\n  view() {\n    const buttonText = this.attrs.uploader.uploading\n      ? app.translator.trans('cmf-upload.site.states.loading')\n      : app.translator.trans('cmf-upload.site.buttons.upload');\n\n    return (\n      <Tooltip text={buttonText}>\n        <Button\n          className={classList([\n            'Button',\n            'hasIcon',\n            'cmf-upload-button',\n            !this.isMediaUploadButton && !this.attrs.uploader.uploading && 'Button--icon',\n            !this.isMediaUploadButton && !this.attrs.uploader.uploading && 'Button--link',\n            this.attrs.uploader.uploading && 'uploading',\n          ])}\n          icon={!this.attrs.uploader.uploading && 'fas fa-file-upload'}\n          onclick={this.uploadButtonClicked.bind(this)}\n          disabled={this.attrs.disabled}\n        >\n          {this.attrs.uploader.uploading && <LoadingIndicator size=\"small\" display=\"inline\" className=\"Button-icon\" />}\n          {(this.isMediaUploadButton || this.attrs.uploader.uploading) && <span className=\"Button-label\">{buttonText}</span>}\n          <form>\n            <input type=\"file\" multiple={true} onchange={this.process.bind(this)} />\n          </form>\n        </Button>\n      </Tooltip>\n    );\n  }\n\n  /**\n   * 处理上传事件。\n   *\n   * @param e\n   */\n  process(e) {\n    // 从输入字段中获取文件\n    const files = this.$('input').prop('files');\n\n    if (files.length === 0) {\n      // 我们没有要上传的文件，因此尝试开始上传将向用户显示错误。\n      return;\n    }\n\n    this.attrs.uploader.upload(files, !this.isMediaUploadButton);\n  }\n\n  /**\n   * 单击上载按钮的事件处理程序\n   *\n   * @param {PointerEvent} e\n   */\n  uploadButtonClicked(e) {\n    // 触发对隐藏输入元素的单击（打开文件对话框）\n    this.$('input').click();\n  }\n}\n","export default class DragAndDrop {\n  constructor(upload, composerElement) {\n    this.upload = upload;\n    this.composerElement = composerElement;\n\n    // Keep references to the bound methods so we can remove the event listeners later\n    this.handlers = {};\n\n    if (!this.supportsFileDragging()) {\n      return;\n    }\n\n    this.composerElement.addEventListener('dragover', (this.handlers.in = this.in.bind(this)));\n\n    this.composerElement.addEventListener('dragleave', (this.handlers.out = this.out.bind(this)));\n    this.composerElement.addEventListener('dragend', this.handlers.out);\n\n    this.composerElement.addEventListener('drop', (this.handlers.dropping = this.dropping.bind(this)));\n  }\n\n  supportsFileDragging() {\n    // Based on https://css-tricks.com/drag-and-drop-file-uploading/\n    const div = document.createElement('div');\n\n    return ('draggable' in div || ('ondragstart' in div && 'ondrop' in div)) && 'FormData' in window && 'FileReader' in window;\n  }\n\n  unload() {\n    // If the handlers were not set (drag and drop not supported), we skip removing them\n    if (!this.handlers.in) {\n      return;\n    }\n\n    this.composerElement.removeEventListener('dragover', this.handlers.in);\n\n    this.composerElement.removeEventListener('dragleave', this.handlers.out);\n    this.composerElement.removeEventListener('dragend', this.handlers.out);\n\n    this.composerElement.removeEventListener('drop', this.handlers.dropping);\n  }\n\n  isNotFile(event) {\n    // Checking event.dataTransfer.files.length does not work on dragover event, it's always zero\n    // So we use the dataTransfer.items property to check whether any file is being dragged\n    if (event.dataTransfer.items) {\n      for (let i = 0; i < event.dataTransfer.items.length; i++) {\n        if (event.dataTransfer.items[i].kind !== 'file') {\n          return true;\n        }\n      }\n    }\n\n    return false;\n  }\n\n  in(event) {\n    if (this.isNotFile(event)) {\n      return;\n    }\n\n    event.preventDefault();\n\n    if (!this.over) {\n      this.composerElement.classList.add('cmf-upload-dragging');\n      this.over = true;\n    }\n  }\n\n  out(event) {\n    if (this.isNotFile(event)) {\n      return;\n    }\n\n    event.preventDefault();\n\n    if (this.over) {\n      this.composerElement.classList.remove('cmf-upload-dragging');\n      this.over = false;\n    }\n  }\n\n  dropping(event) {\n    if (this.isNotFile(event)) {\n      return;\n    }\n\n    event.preventDefault();\n\n    this.upload(event.dataTransfer.files);\n\n    this.composerElement.classList.remove('cmf-upload-dragging');\n  }\n}\n","export default class PasteClipboard {\n  constructor(upload, element) {\n    this.upload = upload;\n\n    // We don't need to remove the events listeners, because they'll get removed when the DOM does.\n    element.addEventListener('paste', this.paste.bind(this));\n  }\n\n  paste(e) {\n    if (e.clipboardData && e.clipboardData.items) {\n      const items = e.clipboardData.items;\n\n      const files = [];\n\n      for (let i = 0; i < items.length; i++) {\n        if (items[i].type.indexOf('image') !== -1) {\n          files.push(items[i].getAsFile());\n        }\n      }\n\n      if (files.length > 0) {\n        e.preventDefault();\n\n        this.upload(files);\n      }\n    }\n  }\n}\n","import app from 'cmf/site/app';\n\nexport default class Uploader {\n  constructor() {\n    this.callbacks = {\n      success: [],\n      failure: [],\n      uploading: [],\n      uploaded: [],\n    };\n    this.uploading = false;\n  }\n\n  on(type, callback) {\n    this.callbacks[type].push(callback);\n  }\n\n  dispatch(type, response) {\n    this.callbacks[type].forEach((callback) => callback(response));\n  }\n\n  upload(files, addBBcode = true) {\n    this.uploading = true;\n    this.dispatch('uploading', files);\n\n    m.redraw(); // Forcing a redraw so that the button also updates if uploadFiles() is called from DragAndDrop or PasteClipboard\n\n    const body = new FormData();\n\n    for (let i = 0; i < files.length; i++) {\n      body.append('files[]', files[i]);\n    }\n\n    // send a POST request to the api\n    return app\n      .request({\n        method: 'POST',\n        url: app.site.attribute('apiUrl') + '/cmf/upload',\n        // prevent JSON.stringify'ing the form data in the XHR call\n        serialize: (raw) => raw,\n        body,\n      })\n      .then((result) => this.uploaded(result, addBBcode))\n      .catch((error) => {\n        this.uploading = false;\n        m.redraw();\n\n        const e = error.response.errors[0];\n\n        if (!e.code.includes('cmf-upload')) {\n          throw error;\n        }\n\n        app.alerts.clear();\n        app.alerts.show(\n          {\n            type: 'error',\n          },\n          e.detail\n        );\n      });\n  }\n\n  uploaded(result, addBBcode = false) {\n    this.uploading = false;\n\n    result.data.forEach((file) => {\n      const fileObj = app.store.pushObject(file);\n\n      // Add file to media manager\n      app.fileListState.addToList(fileObj);\n\n      // Dispatch\n      this.dispatch('success', {\n        file: fileObj,\n        addBBcode,\n      });\n    });\n\n    this.dispatch('uploaded');\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = cmf.core.compat['common/components/Modal'];","const __WEBPACK_NAMESPACE_OBJECT__ = cmf.core.compat['common/components/Alert'];","const __WEBPACK_NAMESPACE_OBJECT__ = cmf.core.compat['common/utils/extractText'];","const image = ['image/png', 'image/jpg', 'image/jpeg', 'image/svg+xml', 'image/gif'];\nconst archive = ['application/zip', 'application/x-7z-compressed', 'application/gzip', 'application/vnd.rar', 'application/x-rar-compressed'];\nconst code = ['text/html', 'text/css', 'text/javascript', 'application/json', 'application/ld+json', 'text/javascript', 'application/x-httpd-php'];\nconst word = [\n  'application/x-abiword',\n  'application/msword',\n  'application/vnd.openxmlformats-officedocument.wordprocessingml.document',\n  'application/pdf',\n];\n\n/**\n * Returns a FontAwesome icon class for a specified MIME type.\n *\n * If it's a known image type, it returns `image` instead.\n *\n * @param {string} fileType MIME type\n * @returns {string} Icon for MIME type\n */\nexport default function mimeToIcon(fileType) {\n  // Display image (do not display for)\n  if (image.includes(fileType)) {\n    return 'image';\n  }\n  // Display image icon for other types\n  else if (fileType.includes('image/')) {\n    return 'far fa-file-image';\n  }\n  // Video icon\n  else if (fileType.includes('video/')) {\n    return 'far fa-file-video';\n  }\n  // Archive icon\n  else if (archive.indexOf(fileType) >= 0) {\n    return 'far fa-file-archive';\n  }\n  // PDF icon\n  else if (fileType === 'application/pdf') {\n    return 'far fa-file-pdf';\n  }\n  // Word\n  else if (word.indexOf(fileType) >= 0) {\n    return 'far fa-file-word';\n  }\n  // Audio icon\n  else if (fileType.includes('audio/')) {\n    return 'far fa-file-audio';\n  }\n  // Code files\n  else if (code.indexOf(fileType) >= 0) {\n    return 'far fa-file-code';\n  }\n\n  return 'far fa-file';\n}\n","import app from 'cmf/site/app';\nimport Component from 'cmf/common/Component';\n\nimport Button from 'cmf/common/components/Button';\nimport Alert from 'cmf/common/components/Alert';\nimport LoadingIndicator from 'cmf/common/components/LoadingIndicator';\n\nimport classList from 'cmf/common/utils/classList';\nimport extractText from 'cmf/common/utils/extractText';\n\nimport mimeToIcon from '../../common/mimeToIcon';\n\nexport default class UserFileList extends Component {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    // Load file list\n    app.fileListState.setUser(vnode.attrs.user || app.session.user);\n\n    this.inModal = vnode.attrs.selectable;\n    this.restrictFileType = vnode.attrs.restrictFileType || null;\n    this.downloadOnClick = this.attrs.downloadOnClick || false;\n    /**\n     * @type {string[]} List of file UUIDs currently being hidden.\n     */\n    this.filesBeingHidden = [];\n\n    /**\n     * The user who's media we are dealing with\n     */\n    this.user = app.fileListState.user;\n  }\n\n  view() {\n    /**\n     * @type {{empty(): boolean, files: import('../../common/models/File').default[]}}\n     */\n    const state = app.fileListState;\n\n    return (\n      <div className=\"cmf-upload-file-list\" aria-live=\"polite\">\n        {/* Loading */}\n        {state.isLoading() && state.files.length === 0 && (\n          <div className={'cmf-upload-loading'}>\n            {app.translator.trans('cmf-upload.site.file_list.loading')}\n\n            <LoadingIndicator />\n          </div>\n        )}\n\n        {/* Empty personal file list */}\n        {this.inModal && state.empty() && (\n          <p className=\"cmf-upload-empty\">\n            <i className=\"fas fa-cloud-upload-alt cmf-upload-empty-icon\" />\n            {app.translator.trans(`cmf-upload.site.file_list.modal_empty_${app.screen() !== 'phone' ? 'desktop' : 'phone'}`)}\n          </p>\n        )}\n\n        {/* Empty file list */}\n        {!this.inModal && state.empty() && (\n          <div className=\"Placeholder\">\n            <p className=\"cmf-upload-empty\">{app.translator.trans('cmf-upload.site.file_list.empty')}</p>\n          </div>\n        )}\n\n        {/* File list */}\n        <ul>\n          {state.files.map((file) => {\n            const fileIcon = mimeToIcon(file.type());\n            const fileSelectable = this.restrictFileType ? this.isSelectable(file) : true;\n\n            const fileClassNames = classList([\n              'cmf-file',\n              // File is image\n              fileIcon === 'image' && 'cmf-file-type-image',\n              // File is selected\n              this.attrs.selectedFiles && this.attrs.selectedFiles.indexOf(file.id()) >= 0 && 'cmf-file-selected',\n            ]);\n\n            /**\n             * File's baseName (file name + extension)\n             * @type {string}\n             */\n            const fileName = file.baseName();\n\n            const isFileHiding = this.filesBeingHidden.includes(file.uuid());\n\n            return (\n              <li aria-busy={isFileHiding}>\n                {app.session.user && (this.user === app.session.user || app.session.user.deleteOthersMediaLibrary()) && (\n                  <Button\n                    className=\"Button Button--icon cmf-file-delete\"\n                    icon=\"far fa-trash-alt\"\n                    aria-label={app.translator.trans('cmf-upload.site.file_list.delete_file_a11y_label', { fileName })}\n                    disabled={isFileHiding}\n                    onclick={this.hideFile.bind(this, file)}\n                  />\n                )}\n\n                <button\n                  className={fileClassNames}\n                  onclick={() => this.onFileClick(file)}\n                  disabled={!fileSelectable || isFileHiding}\n                  aria-label={extractText(app.translator.trans('cmf-upload.site.file_list.select_file_a11y_label', { fileName }))}\n                >\n                  <figure>\n                    {fileIcon === 'image' ? (\n                      <img\n                        src={file.url()}\n                        className=\"cmf-file-image-preview\"\n                        draggable={false}\n                        // Images should always have an `alt`, even if empty!\n                        //\n                        // As we already state the file name as part of the\n                        // button alt label, there's no point in restating it.\n                        //\n                        // See: https://www.w3.org/WAI/tutorials/images/decorative#decorative-image-as-part-of-a-text-link\n                        alt=\"\"\n                      />\n                    ) : (\n                      <span\n                        className=\"cmf-file-icon\"\n                        // Prevents a screen-reader from traversing this node.\n                        //\n                        // This is a placeholder for when no preview is available,\n                        // and a preview won't benefit a user using a screen\n                        // reader anyway, so there is no benefit to making them\n                        // aware of a lack of a preview.\n                        role=\"presentation\"\n                      >\n                        <i className={`fa-fw ${fileIcon}`} />\n                      </span>\n                    )}\n\n                    <figcaption className=\"cmf-file-name\">{fileName}</figcaption>\n\n                    {isFileHiding && (\n                      <span class=\"cmf-file-loading\" role=\"status\" aria-label={app.translator.trans('cmf-upload.site.file_list.hide_file.loading')}>\n                        <LoadingIndicator />\n                      </span>\n                    )}\n                  </figure>\n                </button>\n              </li>\n            );\n          })}\n        </ul>\n\n        {/* Load more files */}\n        {state.hasMoreResults() && (\n          <div className={'cmf-load-more-files'}>\n            <Button className={'Button Button--primary'} disabled={state.isLoading()} loading={state.isLoading()} onclick={() => state.loadMore()}>\n              {app.translator.trans('cmf-upload.site.file_list.load_more_files_btn')}\n            </Button>\n          </div>\n        )}\n      </div>\n    );\n  }\n\n  /**\n   * Execute function on file click\n   *\n   * @param {import('../../common/models/File').default} file\n   */\n  onFileClick(file) {\n    // Custom functionality\n    if (this.attrs.onFileSelect) {\n      this.attrs.onFileSelect(file);\n      return;\n    }\n\n    // Download on click\n    if (this.attrs.downloadOnClick) {\n      window.open(file.url());\n      return;\n    }\n  }\n\n  /**\n   * Check if a file is selectable\n   *\n   * @param {import('../../common/models/File').default} file\n   */\n  isSelectable(file) {\n    const fileType = file.type();\n\n    // Custom defined file types\n    if (Array.isArray(this.restrictFileType)) {\n      return this.restrictFileType.indexOf(fileType) >= 0;\n    }\n\n    // Image\n    else if (this.restrictFileType === 'image') {\n      return fileType.includes('image/');\n    }\n\n    // Audio\n    else if (this.restrictFileType === 'audio') {\n      return fileType.includes('audio/');\n    }\n\n    // Video\n    else if (this.restrictFileType === 'video') {\n      return fileType.includes('video/');\n    }\n\n    return false;\n  }\n\n  /**\n   * Begins the hiding process for a file.\n   *\n   * - Shows a native confirmation dialog\n   * - If confirmed, sends AJAX request to the hide file API\n   *\n   * @param {import('../../common/models/File').default} file File to hide\n   */\n  hideFile(file) {\n    /**\n     * @type {string} File UUID\n     */\n    const uuid = file.uuid();\n\n    if (this.filesBeingHidden.includes(uuid)) return;\n\n    this.filesBeingHidden.push(uuid);\n\n    const confirmHide = confirm(\n      extractText(app.translator.trans('cmf-upload.site.file_list.hide_file.hide_confirmation', { fileName: file.baseName() }))\n    );\n\n    if (confirmHide) {\n      app\n        .request({\n          method: 'PATCH',\n          url: `${app.site.attribute('apiUrl')}/cmf/upload/hide`,\n          body: { uuid },\n        })\n        .then(() => {\n          app.alerts.show(Alert, { type: 'success' }, app.translator.trans('cmf-upload.site.file_list.hide_file.hide_success'));\n        })\n        .catch(() => {\n          app.alerts.show(\n            Alert,\n            { type: 'error' },\n            app.translator.trans('cmf-upload.site.file_list.hide_file.hide_fail', { fileName: file.fileName() })\n          );\n        })\n        .then(() => {\n          // Remove hidden file from state\n          /**\n           * @type {{ files: import('../../common/models/File').default[] }}\n           */\n          const state = app.fileListState;\n\n          const index = state.files.findIndex((file) => uuid === file.uuid());\n          state.files.splice(index, 1);\n\n          // Remove file from hiding list\n          const i = this.filesBeingHidden.indexOf(uuid);\n          this.filesBeingHidden.splice(i, 1);\n        });\n    } else {\n      // Remove file from hiding list\n      const i = this.filesBeingHidden.indexOf(uuid);\n      this.filesBeingHidden.splice(i, 1);\n    }\n  }\n}\n","import Modal from 'cmf/common/components/Modal';\nimport Button from 'cmf/common/components/Button';\nimport UploadButton from './UploadButton';\nimport UserFileList from './UserFileList';\nimport DragAndDrop from './DragAndDrop';\n\nexport default class FileManagerModal extends Modal {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    // 初始化上传管理器\n    this.uploader = vnode.attrs.uploader;\n\n    // 当前选定的文件\n    this.selectedFiles = [];\n\n    // 允许多选\n    this.multiSelect = vnode.attrs.multiSelect || true;\n\n    // 将文件选择限制为特定类型\n    this.restrictFileType = vnode.attrs.restrictFileType || null;\n\n    // 拖放\n    this.dragDrop = null;\n\n    // 初始化上传\n    this.onUpload();\n  }\n\n  className() {\n    return 'Modal--large cmf-file-manager-modal';\n  }\n\n  /**\n   * 初始化拖放\n   */\n  oncreate(vnode) {\n    super.oncreate(vnode);\n\n    this.dragDrop = new DragAndDrop((files) => this.uploader.upload(files, false), this.$().find('.Modal-content')[0]);\n  }\n\n  /**\n   * 从模态内容中删除事件\n   */\n  onremove() {\n    if (this.dragDrop) {\n      this.dragDrop.unload();\n    }\n  }\n\n  view() {\n    const fileCount = this.selectedFiles.length;\n\n    return (\n      <div className={`Modal modal-dialog ${this.className()}`}>\n        <div className=\"Modal-content\">\n          <div className=\"cmf-modal-buttons App-backControl\">\n            <UploadButton uploader={this.uploader} disabled={app.fileListState.isLoading()} isMediaUploadButton />\n          </div>\n\n          <div className=\"cmf-drag-and-drop\">\n            <div className=\"cmf-drag-and-drop-release\">\n              <i className=\"fas fa-cloud-upload-alt\" />\n\n              {app.translator.trans('cmf-upload.site.file_list.release_to_upload')}\n            </div>\n          </div>\n\n          <div className=\"Modal-header\">\n            <h3 className=\"App-titleControl App-titleControl--text\">{app.translator.trans('cmf-upload.site.media_manager')}</h3>\n          </div>\n\n          {this.alertAttrs && (\n            <div className=\"Modal-alert\">\n              <Alert {...this.alertAttrs} />\n            </div>\n          )}\n\n          <div className=\"Modal-body\">\n            <UserFileList\n              user={this.attrs.user}\n              selectable\n              onFileSelect={this.onFileSelect.bind(this)}\n              selectedFiles={this.selectedFiles}\n              restrictFileType={this.restrictFileType}\n            />\n          </div>\n\n          <div className=\"Modal-footer\">\n            <Button onclick={this.hide.bind(this)} className=\"Button\">\n              {app.translator.trans('cmf-upload.site.buttons.cancel')}\n            </Button>\n\n            <Button\n              onclick={this.onSelect.bind(this)}\n              disabled={this.selectedFiles.length === 0 || (!this.multiSelect && this.selectedFiles.length > 1)}\n              className=\"Button Button--primary\"\n            >\n              {app.translator.trans('cmf-upload.site.file_list.confirm_selection_btn', { fileCount })}\n            </Button>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  /**\n   * 在所选文件中添加或删除文件\n   *\n   * @param {File} file\n   */\n  onFileSelect(file) {\n    const itemPosition = this.selectedFiles.indexOf(file.id());\n\n    if (itemPosition >= 0) {\n      this.selectedFiles.splice(itemPosition, 1);\n    } else {\n      if (this.multiSelect) {\n        this.selectedFiles.push(file.id());\n      } else {\n        this.selectedFiles = [file.id()];\n      }\n    }\n  }\n\n  /**\n   * 上传后将文件添加到文件列表\n   */\n  onUpload() {\n    this.uploader.on('success', ({ file }) => {\n      if (this.multiSelect) {\n        this.selectedFiles.push(file.id());\n      } else {\n        this.selectedFiles = [file.id()];\n      }\n    });\n  }\n\n  /**\n   * 将所选文件添加到编辑器\n   */\n  onSelect() {\n    this.hide();\n\n    // 自定义回调\n    if (this.attrs.onSelect) {\n      this.attrs.onSelect(this.selectedFiles);\n\n      return;\n    }\n\n    // 将所选文件添加到编辑器\n    this.selectedFiles.map((fileId) => {\n      const file = app.store.getById('files', fileId);\n\n      app.composer.editor.insertAtCursor(file.bbcode() + '\\n', false);\n    });\n  }\n}\n","import app from 'cmf/site/app';\nimport Component from 'cmf/common/Component';\nimport Button from 'cmf/common/components/Button';\nimport FileManagerModal from './FileManagerModal';\nimport Tooltip from 'cmf/common/components/Tooltip';\n\nexport default class FileManagerButton extends Component {\n  view() {\n    return (\n      <Tooltip text={app.translator.trans('cmf-upload.site.buttons.media')}>\n        {Button.component({\n          className: 'Button cmf-upload-button Button--icon',\n          onclick: this.fileManagerButtonClicked.bind(this),\n          icon: 'fas fa-photo-video',\n        })}\n      </Tooltip>\n    );\n  }\n\n  /**\n   * 单击上传按钮的事件处理程序\n   *\n   * @param {PointerEvent} e\n   */\n  fileManagerButtonClicked(e) {\n    e.preventDefault();\n\n    // 打开对话框\n    app.modal.show(FileManagerModal, {\n      uploader: this.attrs.uploader,\n    });\n  }\n}\n","import app from 'cmf/site/app';\nimport UserPage from 'cmf/site/components/UserPage';\nimport UserFileList from './UserFileList';\n\nexport default class UploadsUserPage extends UserPage {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    this.user = null;\n\n    this.loadUser(m.route.param('username'));\n  }\n\n  content() {\n    if (app.session.user && (app.session.user.viewOthersMediaLibrary() || this.user === app.session.user)) {\n      return (\n        this.user &&\n        UserFileList.component({\n          user: this.user,\n          selectable: false,\n          downloadOnClick: true,\n        })\n      );\n    } else {\n      return null;\n    }\n  }\n\n  show(user) {\n    super.show(user);\n    this.user = user;\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = cmf.core.compat['common/models/User'];","import Uploader from '../handler/Uploader';\nimport DragAndDrop from './DragAndDrop';\nimport FileManagerButton from './FileManagerButton';\nimport FileManagerModal from './FileManagerModal';\nimport UserFileList from './UserFileList';\nimport UploadButton from './UploadButton';\n\nexport const components = {\n  DragAndDrop,\n  FileManagerButton,\n  FileManagerModal,\n  UserFileList,\n  Uploader,\n  UploadButton,\n};\n","import { extend } from 'cmf/common/extend';\nimport app from 'cmf/site/app';\nimport UserPage from 'cmf/site/components/UserPage';\nimport LinkButton from 'cmf/common/components/LinkButton';\n\nimport File from '../common/models/File';\nimport FileListState from './states/FileListState';\nimport downloadButtonInteraction from './downloadButtonInteraction';\nimport addUploadButton from './addUploadButton';\nimport UploadsUserPage from './components/UploadsUserPage';\nimport User from 'cmf/common/models/User';\nimport Model from 'cmf/common/Model';\n\nexport * from './components';\n\napp.initializers.add('cmf-upload', () => {\n  User.prototype.viewOthersMediaLibrary = Model.attribute('cmf-upload-viewOthersMediaLibrary');\n  User.prototype.deleteOthersMediaLibrary = Model.attribute('cmf-upload-deleteOthersMediaLibrary');\n  User.prototype.uploadCountCurrent = Model.attribute('cmf-upload-uploadCountCurrent');\n  User.prototype.uploadCountAll = Model.attribute('cmf-upload-uploadCountAll');\n\n  addUploadButton();\n  downloadButtonInteraction();\n\n  // 文件模型\n  app.store.models.files = File;\n\n  // 文件列表状态\n  app.fileListState = new FileListState();\n\n  // 将用户上传添加到用户配置文件\n  app.routes['user.uploads'] = {\n    path: '/user/:username/files',\n    component: UploadsUserPage,\n  };\n\n  // 将上传添加到用户页面菜单项\n  extend(UserPage.prototype, 'navItems', function (items) {\n    const canUpload = !!app.site.attribute('cmf-upload.canUpload');\n    const hasUploads = !!this.user.uploadCountCurrent();\n\n    if (app.session.user && (app.session.user.viewOthersMediaLibrary() || (this.user === app.session.user && (canUpload || hasUploads)))) {\n      const uploadCount = this.user.uploadCountCurrent();\n\n      items.add(\n        'uploads',\n        LinkButton.component(\n          {\n            href: app.route('user.uploads', {\n              username: this.user.username(),\n            }),\n            name: 'uploads',\n            icon: 'fas fa-file-upload',\n          },\n          [\n            this.user === app.session.user\n              ? app.translator.trans('cmf-upload.site.buttons.media')\n              : app.translator.trans('cmf-upload.site.buttons.user_uploads'),\n            ' ',\n            uploadCount > 0 ? <span className=\"Button-badge\">{uploadCount}</span> : '',\n          ]\n        ),\n        80\n      );\n    }\n  });\n});\n","import app from 'cmf/site/app';\nimport { extend } from 'cmf/common/extend';\nimport TextEditor from 'cmf/common/components/TextEditor';\nimport UploadButton from './components/UploadButton';\nimport DragAndDrop from './components/DragAndDrop';\nimport PasteClipboard from './components/PasteClipboard';\nimport Uploader from './handler/Uploader';\nimport FileManagerButton from './components/FileManagerButton';\n\nexport default function () {\n  extend(TextEditor.prototype, 'oninit', function () {\n    this.uploader = new Uploader();\n  });\n  extend(TextEditor.prototype, 'controlItems', function (items) {\n    if (!app.site.attribute('cmf-upload.canUpload')) return;\n\n    const composerButtonVisiblity = app.site.attribute('cmf-upload.composerButtonVisiblity');\n\n    // Add media button\n    if (composerButtonVisiblity === 'both' || composerButtonVisiblity === 'media-btn') {\n      items.add(\n        'cmf-upload-media',\n        FileManagerButton.component({\n          uploader: this.uploader,\n        })\n      );\n    }\n\n    // Add upload button\n    if (composerButtonVisiblity === 'both' || composerButtonVisiblity === 'upload-btn') {\n      items.add(\n        'cmf-upload',\n        UploadButton.component({\n          uploader: this.uploader,\n        })\n      );\n    }\n  });\n\n  extend(TextEditor.prototype, 'oncreate', function (f_, vnode) {\n    if (!app.site.attribute('cmf-upload.canUpload')) return;\n\n    this.uploader.on('success', ({ file, addBBcode }) => {\n      if (!addBBcode) return;\n\n      this.attrs.composer.editor.insertAtCursor(file.bbcode() + '\\n', false);\n\n      // We wrap this in a typeof check to prevent it running when a user\n      // is creating a new discussion. There's nothing to preview in a new\n      // discussion, so the `preview` function isn't defined.\n      if (typeof this.attrs.preview === 'function') {\n        // Scroll the preview into view\n        // preview() causes the composer to close on mobile, but we don't want that. We want only the scroll\n        // We work around that by temporarily patching the isFullScreen method\n        const originalIsFullScreen = app.composer.isFullScreen;\n\n        app.composer.isFullScreen = () => false;\n\n        this.attrs.preview();\n\n        app.composer.isFullScreen = originalIsFullScreen;\n      }\n    });\n\n    // Gracefully fail if the TextEditor was used in a non-Composer context\n    // Using a custom method to retrieve the target allows other extensions to still use this feature by returning an alternate container\n    const dragAndDropTarget = this.cmfUploadDragAndDropTarget();\n\n    if (dragAndDropTarget) {\n      this.dragAndDrop = new DragAndDrop((files) => this.uploader.upload(files), dragAndDropTarget);\n    }\n\n    new PasteClipboard((files) => this.uploader.upload(files), this.$('.TextEditor-editor')[0]);\n  });\n\n  extend(TextEditor.prototype, 'onremove', function (f_, vnode) {\n    if (!app.site.attribute('cmf-upload.canUpload')) return;\n\n    if (this.dragAndDrop) {\n      this.dragAndDrop.unload();\n    }\n  });\n\n  TextEditor.prototype.cmfUploadDragAndDropTarget = function () {\n    return this.$().parents('.Composer')[0];\n  };\n}\n","import app from 'cmf/site/app';\nimport { extend } from 'cmf/common/extend';\nimport Post from 'cmf/site/components/Post';\n\n/* global $ */\n\nexport default function () {\n  extend(Post.prototype, 'oncreate', function () {\n    this.$('[data-cmf-upload-download-uuid]')\n      .unbind('click')\n      .on('click', (e) => {\n        e.preventDefault();\n        e.stopPropagation();\n\n        if (!app.site.attribute('cmf-upload.canDownload')) {\n          alert(app.translator.trans('cmf-upload.site.states.unauthorized'));\n          return;\n        }\n\n        let url = app.site.attribute('apiUrl') + '/cmf/download';\n\n        url += '/' + encodeURIComponent(e.currentTarget.dataset.cmfUploadDownloadUuid);\n        url += '/' + encodeURIComponent(this.attrs.post.id());\n        url += '/' + encodeURIComponent(app.session.csrfToken);\n\n        window.open(url);\n      });\n  });\n}\n"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","cmf","core","compat","_setPrototypeOf","p","setPrototypeOf","bind","__proto__","_inheritsLoose","subClass","superClass","create","constructor","File","_mixin","apply","arguments","apiEndpoint","this","exists","data","id","mixin","Model","baseName","path","url","type","size","humanSize","createdAt","uuid","tag","hidden","bbcode","FileListState","user","files","moreResults","loading","_proto","setUser","loadResults","offset","app","find","filter","page","then","parseResults","loadMore","length","results","_this$files","push","payload","links","next","m","redraw","addToList","_this$files2","Array","isArray","unshift","hasFiles","isLoading","hasMoreResults","empty","UploadButton","_Component","oninit","vnode","_this","attrs","uploader","on","$","reset","isMediaUploadButton","view","buttonText","uploading","trans","Tooltip","text","Button","className","classList","icon","onclick","uploadButtonClicked","disabled","LoadingIndicator","display","multiple","onchange","process","e","upload","click","Component","DragAndDrop","composerElement","handlers","supportsFileDragging","addEventListener","out","dropping","div","document","createElement","window","unload","removeEventListener","isNotFile","event","dataTransfer","items","i","kind","preventDefault","over","add","remove","PasteClipboard","element","paste","clipboardData","indexOf","getAsFile","Uploader","callbacks","success","failure","uploaded","callback","dispatch","response","forEach","addBBcode","body","FormData","append","method","attribute","serialize","raw","result","error","errors","code","includes","clear","show","detail","_this2","file","fileObj","pushObject","image","archive","word","UserFileList","inModal","selectable","restrictFileType","downloadOnClick","filesBeingHidden","state","map","fileType","fileIcon","fileSelectable","isSelectable","fileClassNames","selectedFiles","fileName","isFileHiding","deleteOthersMediaLibrary","hideFile","onFileClick","extractText","src","draggable","alt","role","class","onFileSelect","open","confirm","Alert","index","findIndex","splice","FileManagerModal","_Modal","multiSelect","dragDrop","onUpload","oncreate","onremove","fileCount","fileListState","translator","alertAttrs","hide","onSelect","itemPosition","_ref","fileId","store","getById","composer","editor","insertAtCursor","Modal","FileManagerButton","fileManagerButtonClicked","UploadsUserPage","_UserPage","loadUser","route","param","content","viewOthersMediaLibrary","component","UserPage","components","User","uploadCountCurrent","uploadCountAll","extend","TextEditor","composerButtonVisiblity","f_","preview","originalIsFullScreen","isFullScreen","dragAndDropTarget","cmfUploadDragAndDropTarget","dragAndDrop","parents","Post","unbind","stopPropagation","encodeURIComponent","currentTarget","dataset","cmfUploadDownloadUuid","post","csrfToken","alert","models","canUpload","hasUploads","uploadCount","LinkButton","href","username","name"],"sourceRoot":""}